# define the prompt depending on some variables:

# one line function to safely source files
function sourceit(){ [ -r "$1" ] && [ -f "$1" ] && source "$1"; }

sourceit $HOME/.functions
# 
# hosname=`hostname`
# if [ ! -e $HOME/.name ] || [ ! -r $HOME/.name ]; then
#   pref="generic" 
# else
#   pref=`grep -v '#' $HOME/.name | head -n 1`
# fi

# see https://github.com/mathiasbynens/dotfiles/blob/master/.bash_prompt
bold='';
reset="\e[m";
black="\e[1;30m";
blue="\e[1;34m";
cyan="\e[1;36m";
green="\e[1;32m";
orange="\e[1;33m";
purple="\e[1;35m";
red="\e[1;31m";
violet="\e[1;35m";
white="\e[1;37m";
yellow="\e[1;33m";
grey="\e[30;1m"
brown="\e[0;33m"

# show user only if it is root
if [[ "${USER}" == "root" ]]; then
  user="<root>";
else
  user="";
fi;

# color clue about host
# you could set hostColor to a color name in ~/.extrarc depending on hostname
case $hostColor in 
  cyan)
  HC=${cyan}
  ;;
  blue)
  HC=${blue}
  ;;
  *)
  HC=${white} # not a know host
esac

# color clue about filesystem (usually the physcal location) 
case $fsName in
  generic|white)
  color=$white
  ;;
  green)
  color=$green
  ;;
  blue)
  color=$blue
  ;;
  orange)
  color=$orange
  ;;
  purple)
  color=$purple
  ;;
  cyan)
  color=$cyan
  ;;
  *)
  color=$white
  # PS1="\[\e[36m\][\W]\$ \[\e[0m\]"
esac

divs=${grey}
repo=${orange}
modified=${red}
staged=${green}

# git info can be switched on setting variable $SHOW_GIT to 1
# might slow down the creation of the prompt
GIT_INFO=""
if [ $SHOW_GIT -eq 1 ]; then
  GIT_INFO+="-(\[${color}\]"; # set starting color
  GIT_INFO+="\[${repo}\]\$(__git_ps1)"; # white git branch
  GIT_INFO+="\[${divs}\]:";
  GIT_INFO+="\[${staged}\]\$(__git_staged)"; # num of staged files
  GIT_INFO+="\[${divs}\],";
  GIT_INFO+="\[${modified}\]\$(__git_modified)"; # num of modified files
  GIT_INFO+="\[${divs}\])";
fi

PS1="\[${divs}\](";
PS1+="\[${HC}\]"; # set host color 
PS1+="\h"; # hostname
PS1+="\[${divs}\])-("; # working directory
PS1+="\[${color}\]"; # set starting color
PS1+="\w"; # working directory
PS1+="\[${divs}\])"; # working directory
PS1+=$GIT_INFO
PS1+="\n\[${color}\]\$ \[${reset}\]"; # newline, $, space and reset color

export PS1;
